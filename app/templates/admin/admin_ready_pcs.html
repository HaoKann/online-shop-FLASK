{% extends 'admin/base.html' %}
{% from 'bootstrap5/pagination.html' import render_pagination %}

{% block content %}
    <div class="container">   


    <div class="row mb-4 align-items-center">
        <div class="col-md-6">
            <h1>Готовые сборки</h1>
        </div>
        <div class="col-md-6 text-end">
            <a href="{{ url_for('admin.admin_add_readypc') }}" class="btn btn-primary">
                <i class="bi bi-plus-lg"></i> Добавить новую сборку
            </a>
        </div>
    </div>

    {# Опционально: можно добавить поиск по сборкам для единообразия #}
    <form class="d-flex mb-4" role="search" action="#" method="GET">
        <input class="form-control me-2" name="q" placeholder="Поиск по названию сборки..." aria-label="Search">
        <button class="btn btn-outline-light" type="submit">Поиск</button>
    </form>

    {% if all_ready_pc.items %}
        <div class="table-responsive">
            <table class="admin-table w-100">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Название</th>
                        <th>Категория</th>
                        <th>Цена</th>
                        <th>Статус</th>
                        <th class="text-end">Действия</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ready_pc in all_ready_pc.items %}
                        <tr>
                            <td>{{ ready_pc.id }}</td>
                            <td>
                                <a href="{{ url_for('admin.admin_ready_pc_detail', id=ready_pc.id) }}" class="text-decoration-none text-white">
                                    {{ ready_pc.name }}
                                a>
                            </td>
                            <td>{{ ready_pc.category }}</td>
                            <td>{{ "{:,.0f}".format(ready_pc.price).replace(",", " ") }} ₸</td>
                            <td>
                                {% if ready_pc.is_ready() %}
                                    <span class="badge bg-success">Готова</span>
                                {% else %}
                                    <span class="badge bg-secondary" 
                                          title="Не хватает: {{ ready_pc.get_absent_categories().values()|join(', ') }}">
                                        Не готова
                                    </span>
                                {% endif %}
                            </td>
                            <td class="text-end">
                                <div class="table-actions">
                                    <a href="{{ url_for('admin.admin_edit_readypc', id=ready_pc.id) }}" class="action-icon action-edit" title="Редактировать">
                                        <i class="bi bi-pencil-fill"></i>
                                    </a>
                                    <a href="{{ url_for('admin.admin_delete_readypc', id=ready_pc.id) }}" class="action-icon action-delete" title="Удалить">
                                        <i class="bi bi-trash-fill"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <nav aria-label="Page navigation" class="mt-4 d-flex justify-content-center">
            {{ render_pagination(all_ready_pc, endpoint='admin.admin_ready_pcs') }}
        </nav>
    {% else %}
        <p class="text-muted mt-4">Готовых сборок пока нет.</p>
    {% endif %}
</div> 
{% endblock %}